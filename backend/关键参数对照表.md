# 🔑 AIPPOF系统关键参数完整列表

## 📐 参数符号与论文对应关系

根据您提到的参数符号 $(t_{min}, t_{max}, k, \theta, \gamma)$，以下是代码中的对应关系：

---

## 一、T3计算模块关键参数

### 1.1 双Logistic函数参数（`api/t3_calculator.py`）

**公式**:
$$t_3 = L_1 + \frac{L_2 - L_1}{1 + e^{-k_1(T_2 - T_{2,mid})}} + \frac{L_3}{1 + e^{-k_2(w - w_{high})}}$$

**参数定义**:

| 代码符号 | 论文符号（可能） | 数值 | 含义 | 单位 |
|---------|----------------|------|------|------|
| `L1` | $t_{min}$ | **0.0** | 最低税率（下界） | % |
| `L2` | $t_{max,base}$ | **7.0** | 中档税率 | % |
| `L3` | $t_{max,income}$ | **7.0** | 高收入附加税率 | % |
| `T2_mid` | $\theta_{T2}$ | **5.0** | T2中值（拐点） | % |
| `w_high` | $w_0$ | **500,000** | 高收入阈值 | 元/年 |
| `k1` | $k_{T2}$ | **2.0** | T2敏感度系数 | - |
| `k2` | $k_w$ | **0.00001** | 收入敏感度系数 | - |

**年龄调整参数**:
```python
age_threshold = 55          # 开始年龄折扣的门槛
age_discount_rate = 0.02    # 每年降低0.02%
```

### 1.2 T3的取值范围
- **最小值**: 0% (低T2 + 低收入 + 高龄)
- **最大值**: 14% (理论上限，实际很难达到)
- **典型值**: 0.2%-5% (大多数参与者)

---

## 二、动态上限模块关键参数

### 2.1 动态上限比例（`api/cap_calculator.py`）

**公式**:
$$C_{dynamic} = \alpha \times w$$

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `cap_ratio` | $\alpha$ | **0.08** | 动态上限比例（8%工资） | - |

### 2.2 固定上限平滑函数参数

**公式**:
$$C_{fixed}(t_2) = C_{base} + \sum_{i=1}^{3} \Delta_i \times \sigma(k \times (t_2 - thr_i))$$

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `nodes[0]` | $C_1$ | **12,000** | 第一档固定上限 | 元 |
| `nodes[1]` | $C_2$ | **24,000** | 第二档固定上限 | 元 |
| `nodes[2]` | $C_3$ | **48,000** | 第三档固定上限 | 元 |
| `nodes[3]` | $C_4$ | **72,000** | 第四档固定上限 | 元 |
| `thresholds[0]` | $\theta_1$ | **0.03** | 第一阈值（3% T2） | - |
| `thresholds[1]` | $\theta_2$ | **0.05** | 第二阈值（5% T2） | - |
| `thresholds[2]` | $\theta_3$ | **0.10** | 第三阈值（10% T2） | - |
| `k` | $k_{smooth}$ | **20.0** | S型函数斜率（平滑度） | - |

### 2.3 高收入递减因子参数

**公式**:
$$\tau(w) = \tau_{min} + (1 - \tau_{min}) \times \left(1 - \sigma\left(\frac{w - w_0}{b}\right)\right)$$

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `tau_min` | $\tau_{min}$ | **0.5** | 最低折扣（50%递减） | - |
| `w0_pivot` | $w_0$ | **200,000** | 收入递减起点 | 元/年 |
| `b_width` | $b$ | **100,000** | 递减平滑宽度 | 元/年 |

---

## 三、补贴模块关键参数

### 3.1 基础补贴参数（`api/subsidy_calculator.py`）

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `base_grant` | $G_0$ | **150** | 固定补贴 | 元 |
| `c_min` | $C_{min}$ | **200** | 最低缴费额 | 元 |
| `c0_ratio_of_wage` | $\beta$ | **0.02** | 第一档缴费基数比例（2%） | - |

### 3.2 匹配比例参数

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `ratio_low` | $\gamma_1$ | **0.30** | 低档匹配率（30%） | - |
| `ratio_high` | $\gamma_2$ | **0.06** | 高档匹配率（6%） | - |

### 3.3 低收入倾斜参数

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `uplift_low` | $\epsilon$ | **0.5** | 低收入加成比例（+50%） | - |
| `low_income_cut` | $w_{low}$ | **80,000** | 低收入界定标准 | 元/年 |

### 3.4 补贴递减参数

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `taper_w_low` | $w_L$ | **40,000** | 全额补贴上限 | 元/年 |
| `taper_w_high` | $w_H$ | **100,000** | 补贴归零下限 | 元/年 |

**递减公式**:
$$\lambda(w) = \begin{cases}
1.0, & w \leq w_L \\
\frac{w_H - w}{w_H - w_L}, & w_L < w < w_H \\
0.0, & w \geq w_H
\end{cases}$$

---

## 四、个税计算参数

### 4.1 税前扣除（`api/t2_calculator.py`）

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `EXEMPTION` | $E$ | **60,000** | 年度免征额 | 元/年 |

### 4.2 综合所得税率表（7档累进）

| 应纳税所得额区间 | 税率 | 速算扣除数 |
|-----------------|------|-----------|
| 0 - 36,000 | **3%** | 0 |
| 36,000 - 144,000 | **10%** | 2,520 |
| 144,000 - 300,000 | **20%** | 16,920 |
| 300,000 - 420,000 | **25%** | 31,920 |
| 420,000 - 660,000 | **30%** | 52,920 |
| 660,000 - 960,000 | **35%** | 85,920 |
| 960,000+ | **45%** | 181,920 |

---

## 五、NPV计算参数

### 5.1 宏观经济假设（`api/contribution_suggestions.py`）

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `wage_growth_rate` | $g_w$ | **3.5** | 工资年增长率 | % |
| `discount_rate` | $r$ | **3.0** | 折现率 | % |

### 5.2 生命周期参数

| 代码符号 | 论文符号 | 数值 | 含义 | 单位 |
|---------|---------|------|------|------|
| `retirement_age` | $R$ | **60** | 退休年龄 | 岁 |
| `withdrawal_years` | $T_w$ | **20** | 领取期限 | 年 |
| `life_expectancy` | $L$ | **80** | 预期寿命 | 岁 |

---

## 六、五档方案比例参数

| 方案名称 | 代码符号 | 数值 | 含义 |
|---------|---------|------|------|
| 保守型 | `conservative_tier` | **0.30** | 30%上限利用率 |
| 稳健型 | `stable_tier` | **0.50** | 50%上限利用率 |
| 均衡型（推荐）⭐ | `balanced_tier` | **0.70** | 70%上限利用率 |
| 积极型 | `aggressive_tier` | **0.85** | 85%上限利用率 |
| 激进型 | `maximum_tier` | **0.95** | 95%上限利用率 |

---

## 七、Logistic/Sigmoid函数通用形式

系统中多处使用Logistic函数（S型曲线）实现平滑过渡：

**标准形式**:
$$\sigma(x) = \frac{1}{1 + e^{-x}}$$

**应用场景**:
1. **T3双Logistic**: 基于T2和收入的税率计算
2. **固定上限平滑**: 避免T2阈值处的突变
3. **高收入递减**: 200k附近的平滑过渡
4. **补贴递减**: 40k-100k区间的线性递减

---

## 八、关键参数敏感性分级

### 🔴 高敏感度参数（改动影响>20%）
1. **工资增长率** `wage_growth_rate = 3.5%`
2. **折现率** `discount_rate = 3.0%`
3. **T2中值** `T2_mid = 5.0%`
4. **补贴低档配比** `ratio_low = 0.30`

### 🟡 中敏感度参数（改动影响5%-20%）
5. **动态上限比例** `cap_ratio = 0.08`
6. **高收入拐点** `w0_pivot = 200,000`
7. **补贴递减区间** `(40k, 100k)`
8. **T2敏感度** `k1 = 2.0`

### 🟢 低敏感度参数（改动影响<5%）
9. **固定补贴** `base_grant = 150`
10. **收入敏感度** `k2 = 0.00001`
11. **S型平滑度** `k = 20.0`
12. **最低缴费额** `c_min = 200`

---

## 九、与您提到的符号对应表

根据您的问题 "$(t_{min}, t_{max}, k, \theta, \gamma)$"，最可能的对应关系：

| 您的符号 | 代码实现 | 数值 | 含义 |
|---------|---------|------|------|
| $t_{min}$ | `L1` | **0.0%** | T3最低税率 |
| $t_{max}$ | `L2 + L3` | **7.0% + 7.0% = 14.0%** | T3理论最大值 |
| $k$ | `k1` 或 `k` | **2.0** 或 **20.0** | Logistic敏感度系数 |
| $\theta$ | `T2_mid` 或 `thresholds` | **5.0%** 或 **(3%, 5%, 10%)** | 阈值/拐点参数 |
| $\gamma$ | `ratio_low` | **0.30** | 补贴匹配率 |

**备注**: 
- 如果您的论文中使用不同的符号体系，请提供具体的公式编号或章节，我可以进一步精确映射
- 当前参数基于代码实现，已在测试案例中验证有效

---

## 十、参数修改指南

### 10.1 如何修改参数

**T3参数**（文件：`api/t3_calculator.py`, 第37-43行）:
```python
L1 = 0.0      # 修改最低税率
L2 = 7.0      # 修改中档税率
L3 = 7.0      # 修改高收入附加税率
T2_mid = 5.0  # 修改T2拐点
w_high = 500000  # 修改高收入阈值
k1 = 2.0      # 修改T2敏感度
k2 = 0.00001  # 修改收入敏感度
```

**上限参数**（文件：`api/cap_calculator.py`）:
```python
# 第32行：动态比例
cap_ratio = 0.08

# 第47-49行：固定上限节点和阈值
nodes = (12000.0, 24000.0, 48000.0, 72000.0)
thresholds = (0.03, 0.05, 0.10)
k = 20.0

# 第86-88行：高收入递减
tau_min = 0.5
w0_pivot = 200000.0
b_width = 100000.0
```

**补贴参数**（文件：`api/subsidy_calculator.py`, 第18-37行）:
```python
@dataclass
class SubsidyParams:
    base_grant: float = 150.0       # 固定补贴
    ratio_low: float = 0.30         # 低档匹配率
    ratio_high: float = 0.06        # 高档匹配率
    uplift_low: float = 0.5         # 低收入加成
    low_income_cut: float = 80000.0 # 低收入界定
    taper_w_low: float = 40000.0    # 补贴全额上限
    taper_w_high: float = 100000.0  # 补贴归零下限
```

### 10.2 修改后需要重启服务
```bash
# 后端重启
cd backend
python main.py

# 前端无需重启（仅调用后端API）
```

---

**文档生成日期**: 2025年11月3日  
**版本**: v1.0  
**适用系统**: AIPPOF个人养老金优化框架
